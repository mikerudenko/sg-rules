rules:
  - id: identify-internal-state-variable
    patterns:
      - pattern: |
          contract $CONTRACT_NAME {
            ...
            $VISIBILITY $TYPE $VAR;
            ...
          }
    message: "Internal state variable '$VAR' detected in contract '$CONTRACT_NAME'."
    severity: INFO
    languages: [solidity]
    metadata:
      category: style
      technology: solidity

  - id: detect-variable-shadowing
    patterns:
      - pattern-either:
          - pattern: |
              contract $CONTRACT_NAME {
                ...
                $VISIBILITY $TYPE $VAR;
                ...
                function $FUNC_NAME(...) $MODIFIERS {
                  ...
                  $INNER_VISIBILITY $INNER_TYPE $VAR = ...;
                  ...
                }
                ...
              }
          - pattern: |
              contract $CONTRACT_NAME {
                ...
                $VISIBILITY $TYPE $VAR;
                ...
                function $FUNC_NAME(...) $MODIFIERS {
                  ...
                  $INNER_TYPE $VAR = ...;
                  ...
                }
                ...
              }
    message: "Variable shadowing detected: '$VAR' shadows an internal state variable in function '$FUNC_NAME' of contract '$CONTRACT_NAME'."
    severity: WARNING
    languages: [solidity]
    metadata:
      category: bug
      technology: solidity
